<div class="container">
  <div class="form-container">
    <!-- <p>debugging: {{instructors}}</p> -->
    <form [formGroup]="newForm">
      <!-- course details - number, name, term -->
      <div class="input-group mb-3">
        <div class="input-group-prepend">
          <label class="input-group-text" for="courseDetail"> Course </label>
        </div>
        <select class="custom-select" id="courseDetail"
          formControlName="courseDetail">
          <option *ngFor='let c of courseDetails' [value]=c.course_no>
            {{c.course_no}} {{c.course_name}}
          </option>
        </select>
      </div>

      <!-- core or elective? -->
      <div class="form-group">
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" id="core" 
             formControlName="core"
             value="1">
            <label class="form-check-label" for="core"> Core </label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" id="elective"
          formControlName="core"  
          value="0">
          <label class="form-check-label" for="elective"> Elective </label>
        </div>  
      </div>
      
      <div class="dropdown-divider"></div>
      
      <!-- number of cohorts to enrol -->
      <div class="input-group mb-3">
        <div class="input-group-prepend">
          <label class="input-group-text" for="no_classes"> Number of Cohort Classes enrolled to course </label>
        </div>
        <select class="custom-select" id="no_classes"
          formControlName="no_classes">
          <option *ngFor='let i of no_classesRange' [value]='i'>{{i}}</option>
        </select>
      </div>

      <!-- class size  -->
      <div class="input-group mb-3">
        <div class="input-group-prepend">
          <label class="input-group-text" for="class_size"> Size of each Cohort Class </label>
        </div>
        <select class="custom-select" id="class_size"
          formControlName="class_size">
          <option *ngFor='let i of class_sizeRange' [value]='i'>{{i}}</option>
        </select>
      </div>

      <div class="dropdown-divider"></div>

      <!-- instructor details -->
      <div class="form-group no-ugly-red-line" formArrayName="prof_list">
        <h6>Details of Teaching Professors</h6>
        <div *ngFor="let prof of newForm.controls.prof_list.controls; let a=index" formGroupName="{{a}}"
        class="no-ugly-red-line">
          <h5>Professor {{a+1}}
            <span style="float: right;"><button mat-icon-button (click)="deleteProf(a)">
              <i class="fas fa-trash-alt"></i>
            </button></span>
          </h5>
          <div class="form-group">
            <select class="custom-select" formControlName="id">
              <option *ngFor='let prof of instructors' [value]=prof.id>
                {{prof.pillar}} - {{prof.name}}
              </option>
            </select>
          </div>
        </div>

        <button type="button" class="btn btn-primary" 
          (click)="addProfToCourse()">
          Add an Instructor
        </button>
      </div>

      <div class="dropdown-divider"></div>

      <!-- sessions -->
      <div class="form-group no-ugly-red-line" formArrayName="sessions">
        <h6>Details of all Sessions necessary</h6>
        <div *ngFor="let sesh of newForm.controls.sessions.controls; let b=index"
        formGroupName="{{b}}" class="no-ugly-red-line">
          <!-- repeated segment -->
          <h5>Session {{b+1}} 
            <span style="float: right;"><button mat-icon-button (click)="deleteSession(b)">
              <i class="fas fa-trash-alt"></i>
            </button></span>
          </h5>
          <!-- type of lesson -->
          <div class="input-group mb-3">
            <div class="input-group-prepend">
              <label class="input-group-text" for="class_type"> Type of Class </label>
            </div>
            <select class="custom-select" id="class_type"
              formControlName="class_types">
              <option *ngFor='let i of class_type' [value]='i'>{{i}}</option>
            </select>
          </div>
          <!-- duration of each lesson in hours -->
          <div class="input-group mb-3">
            <div class="input-group-prepend">
              <label class="input-group-text" for="duration"> Duration </label>
            </div>
            <select class="custom-select" id="duration"
              formControlName="sessions_hrs">
              <option *ngFor='let i of durations' [value]='i'>{{i}}</option>
            </select>
          </div>

          <!-- profs involved -->  
          <div class="form-inline no-ugly-red-line" formArrayName="profs_involved">
            <p>Professors involved</p>
            <div *ngFor="let prof of newForm.controls.sessions.controls.'b'.profs_involved; let d=index" formGroupName="{{d}}" class="form-control no-ugly-red-line">
              <select class="custom-select" formControlName="profId">
                <option *ngFor='let p of prof_list.controls' [value]="p.controls['id'].value">
                  {{queryInstructors(p.controls['id'].value)}}</option>
              </select>
              <button (click)="deleteProfFromSession(d)" class="btn btn-light">
                <i class="fas fa-times"></i>
              </button>
            </div>
          </div>

          <!-- end of repeated segment -->
          <button type="button" class="btn btn-primary" 
            (click)="addProfToSession(b)">
            <i class="fas fa-plus"></i>
          </button>
        </div>                       
        <!-- add new session -->
        
      </div>

      <div class="dropdown-divider"></div>

      <!-- button managers -->
      <div style="float: right;">
        <button id="addCourseSubmitButton" type="submit" class="btn btn-success" 
        [disabled]="newForm.status=='INVALID'"
        (click)="onSend(); newForm.reset()">Submit Course</button>
        <button class="btn btn-warning" 
        (click)="newForm.reset()">Reset</button>
      </div>
    </form>
    <p>Form values: {{newForm.value | json : 2 }} </p>
    <p>Form status: {{newForm.status | json}} </p>
  </div>
</div>
